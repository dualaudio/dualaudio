<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Audio Player with Gain Control</title>
</head>
<body>

<h1>Independent Volume Audio Player</h1>

<!-- Player 1 -->
<div>
  <h2>Player 1</h2>
  <input type="file" accept=".mp3, .wav, .m4a, .aac, .ogg, .flac" id="audioFile1" onchange="loadAudio(1)">
  <button onclick="togglePlayPause(1)" id="playPauseBtn1">Play</button>
  <input type="range" id="volumeSlider1" min="0" max="1" step="0.1" value="0.5" onchange="setVolume(1)">
  <label for="volumeSlider1">Volume</label>
</div>

<!-- Player 2 -->
<div>
  <h2>Player 2</h2>
  <input type="file" accept=".mp3, .wav, .m4a, .aac, .ogg, .flac" id="audioFile2" onchange="loadAudio(2)">
  <button onclick="togglePlayPause(2)" id="playPauseBtn2">Play</button>
  <input type="range" id="volumeSlider2" min="0" max="1" step="0.1" value="0.5" onchange="setVolume(2)">
  <label for="volumeSlider2">Volume</label>
</div>

<script>
  // Audio context and gain nodes
  const audioContext1 = new (window.AudioContext || window.webkitAudioContext)();
  const gainNode1 = audioContext1.createGain();
  gainNode1.connect(audioContext1.destination);

  const audioContext2 = new (window.AudioContext || window.webkitAudioContext)();
  const gainNode2 = audioContext2.createGain();
  gainNode2.connect(audioContext2.destination);

  // Variables to store audio elements and their states
  let player1 = null;
  let player2 = null;
  let isPlaying1 = false;
  let isPlaying2 = false;

  // Load Audio File for Player
  function loadAudio(playerNumber) {
    const fileInput = document.getElementById(`audioFile${playerNumber}`);
    const file = fileInput.files[0];
    if (!file) return;

    const audioUrl = URL.createObjectURL(file);
    
    if (playerNumber === 1) {
      if (player1) player1.disconnect();
      player1 = new Audio(audioUrl);
      const track = audioContext1.createMediaElementSource(player1);
      track.connect(gainNode1);
      isPlaying1 = false;
      document.getElementById("playPauseBtn1").textContent = "Play";
    } else if (playerNumber === 2) {
      if (player2) player2.disconnect();
      player2 = new Audio(audioUrl);
      const track = audioContext2.createMediaElementSource(player2);
      track.connect(gainNode2);
      isPlaying2 = false;
      document.getElementById("playPauseBtn2").textContent = "Play";
    }
  }

  // Toggle Play/Pause for Audio Player
  function togglePlayPause(playerNumber) {
    if (playerNumber === 1 && player1) {
      if (isPlaying1) {
        player1.pause();
        document.getElementById("playPauseBtn1").textContent = "Play";
      } else {
        player1.play();
        audioContext1.resume(); // Resume context if suspended
        document.getElementById("playPauseBtn1").textContent = "Pause";
      }
      isPlaying1 = !isPlaying1;
    } else if (playerNumber === 2 && player2) {
      if (isPlaying2) {
        player2.pause();
        document.getElementById("playPauseBtn2").textContent = "Play";
      } else {
        player2.play();
        audioContext2.resume(); // Resume context if suspended
        document.getElementById("playPauseBtn2").textContent = "Pause";
      }
      isPlaying2 = !isPlaying2;
    }
  }

  // Set Volume for Audio Player
  function setVolume(playerNumber) {
    const volume = parseFloat(document.getElementById(`volumeSlider${playerNumber}`).value);
    if (playerNumber === 1) {
      gainNode1.gain.value = volume;
    } else if (playerNumber === 2) {
      gainNode2.gain.value = volume;
    }
  }
</script>

</body>
</html>